[user]
name = "Drew Olson"
email = "drew@drewolson.org"

[templates]
draft_commit_description = '''
concat(
  coalesce(description, default_commit_description, "\n"),
  surround(
    "\nJJ: This commit contains the following changes:\n", "",
    indent("JJ:     ", diff.stat(72)),
  ),
  "\nJJ: ignore-rest\n",
  diff.git(),
)
'''

[ui]
default-command = "log"

[aliases]
ff = ["bookmark", "move", "--from", "trunk()", "--to", "@-"]
ll = ["log", "-n", "10", "-r", "all()"]
sync = ["util", "exec", "--", "bash", "-c", """
set -euo pipefail
jj git fetch
jj rebase -d trunk() -b @
""", ""]
push = ["util", "exec", "--", "bash", "-c", """
set -euo pipefail
jj ff
jj git push
""", ""]
pr-fetch = ["util", "exec", "--", "bash", "-c", """
set -euo pipefail
git fetch $1 pull/$2/head:pr/$2
""", ""]

[revset-aliases]
"my_work()" = "heads(mine() & mutable()) | @"
"github_custom_focus()" = "none()"
"github_focus()" = "github_custom_focus() | present(main@upstream) | bookmarks() | trunk() | my_work()"
"github_leaves()" = "(github_focus() | conflicts() | my_work()::) & visible()"
"github_fork_point()" = "fork_point(github_focus())"
"github()" = "github_fork_point()::(github_leaves() | github_focus())"

[revsets]
log = "github()"
